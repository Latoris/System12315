<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd" >  
<mapper namespace="com.latoris.consume.mapper.CountMapper" >    
    <resultMap id="CountEnterpriseResultMap" type="com.latoris.consume.beans.VOBean"> 
    	<result column="name" property="name" jdbcType="VARCHAR" />    
        <result column="count" property="count" jdbcType="INTEGER" />  
    </resultMap>  
  
     
	<select id="CountByEnterprise"  resultType="com.latoris.consume.beans.VOBean">
		select enterprise.name, a.count from (select eid, sum(count) count from enterprise_daily_result 
		where submit_time between #{para.startTime} and #{para.endTime} 
	    GROUP BY eid)a 
	    left join enterprise on a.eid=enterprise.eid order by a.count desc
	</select>
	<!--
	<select id="CountByPurchaseWay"  resultType="com.latoris.consume.beans.VOBean">
		select purchase_way as name, sum(count) count from enterprise_daily_result 
		where submit_time between #{para.startTime} and #{para.endTime} 
	    GROUP BY purchase_way
	</select>
	
	<select id="CountByAmount"  resultType="com.latoris.consume.beans.VOBean">
		select amount as name, sum(count) count from enterprise_daily_result 
		where submit_time between #{para.startTime} and #{para.endTime} 
	    GROUP BY amount
	</select>
	
	<select id="CountByMerchandiseTypeFirst"  resultType="com.latoris.consume.beans.VOBean">
		select product_type.CPFLMC, a.count from (select merchandise_type, sum(count) count 
		from merchandiseType_first_daily_result 
		where submit_time between #{para.startTime} and #{para.endTime} 
	    GROUP BY eid
        order by count desc)a join enterprise on a.eid=enterprise.eid
	</select>-->
	
	<!-- 二级类目 比如油粮、等 
	<select id="CountByMerchandiseTypeSecond"  resultType="com.latoris.consume.beans.VOBean">
		select product_type.CPFLMC, a.count from (select merchandise_type, sum(count) count 
		from merchandiseType_first_daily_result 
		where submit_time between #{para.startTime} and #{para.endTime} 
	    GROUP BY eid
        order by count desc)a join enterprise on a.eid=enterprise.eid
	</select>
    -->
    
    <select id="CountBySubmitTime"  resultType="com.latoris.consume.beans.VOBean">
		select substring(submit_time,1,10) name, count from all_daily_result 
		where submit_time between #{para.startTime} and #{para.endTime} order by submit_time ASC
	</select>
</mapper>  