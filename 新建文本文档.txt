CREATE TABLE default.auser( 
uid bigint ,
card_type int ,
card_num string ,
sex string,
birthday date ,
name string ,
username string ,
password string ,
phone string,
addr string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t';

CREATE TABLE IF NOT EXISTS default.product_type(
FLCODE string,
CPFLMC string ,
FLQC string ,
PYJP string ,
PYQP string)
ROW FORMAT DELIMITED FIELDS TERMINATED BY '\t';

LOAD DATA LOCAL INPATH '/www/wwwroot/user.txt' INTO TABLE auser

select ROUND(datediff(current_date(), birthday)/365.2422), uid, birthday
from default.auser

select substring(merchandise_type,1,3) type, submit_time, count(1) as count
from default.complaint GROUP BY submit_time, type

select b.CPFLMC as name,a.type,a.submit_time, a.count from
(select substring(merchandise_type,1,3) type, submit_time, count(1) as count
from complaint where submit_time between '2018-04-28' and '2018-05-01' GROUP BY submit_time, type) a 
(select distinct substring(FLCODE,1,3) as typeb, CPFLMC from product_type)b
where a.type=b.typeb